@{
    if (!Request.IsAjaxRequest())
    {
        Layout = "~/Views/Shared/PublicLayouts/_clientLayout.cshtml";
    }
    ViewBag.Title = "Восстановление пароля";
}
<form class="forgot-password comment_form  form-horizontal">
    <p>Пожалуйста, введите Email, на который зарегистрирован ваш аккаунт. На этот адрес будут высланы инструкции по восстановлению пароля.</p>
    <input class="restore-password-email email" type="text" data-val="true" data-val-required="*" />
    <button type="button" class="password-restore">Восстановить</button>
    <p class="ticket-success" style="display:none">Инструкции высланы на ваш Email. Не забывайте свои пароли! :)</p>
</form>

@JsInline(
@<script>
    $(function() {
        $("button.password-restore").removeAttr("disabled");
        $("button.password-restore").click(function() {
            var $form = $(this).closest("form");
            jQuery.validator.unobtrusive.parse($form);

            if ($form.valid()) {

                $(this).attr("disabled", "disabled");
                var input = $('.restore-password-email');
                var value = input.val();
                postJSON('/api/user/password/createTicket/' + value, null, function(res) {
                    if (res.succeed) {
                        input.val("");
                        $("p.ticket-success").show();
                    } else if (res.message) {
                        $("button.password-restore").removeAttr("disabled");
                        smartAlert(res.message);
                    } else {
                        $("button.password-restore").removeAttr("disabled");
                        smartAlert("При восстановлении пароля произошла ошибка");
                    }
                });
            } else {

                $form.validate().focusInvalid();
            }
        });
    });
</script>
)